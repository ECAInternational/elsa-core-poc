{"id":"f7fce6853a51f2ca","definitionId":"89364c19b25f3a35","name":"Document Approval Workflow","createdAt":"2024-10-24T21:30:28.141597+00:00","version":4,"toolVersion":"3.2.0.0","variables":[{"id":"1c6cf9c82c0c6e06","name":"DocumentSigningRetryCount","typeName":"Int32","isArray":false,"value":"0","storageDriverTypeName":"Elsa.Workflows.Services.WorkflowInstanceStorageDriver, Elsa.Workflows.Core"},{"id":"e0fceb85e4b752cc","name":"DocumentSigned","typeName":"Boolean","isArray":false,"value":"False","storageDriverTypeName":"Elsa.Workflows.Services.WorkflowInstanceStorageDriver, Elsa.Workflows.Core"}],"inputs":[{"uiHint":"singleline","storageDriverType":"Elsa.Workflows.Services.WorkflowInstanceStorageDriver, Elsa.Workflows.Core","type":"String","name":"DocumentTemplate","displayName":"Document Template","category":"Primitives","isArray":false},{"uiHint":"singleline","storageDriverType":"Elsa.Workflows.Services.WorkflowInstanceStorageDriver, Elsa.Workflows.Core","type":"String","name":"TaskName","displayName":"Task Name","category":"Primitives","isArray":false}],"outputs":[{"type":"Boolean","name":"SigningOutcome","displayName":"Signing Outcome","category":"Primitives","isArray":false}],"outcomes":["Signed","NotSigned"],"customProperties":{},"isReadonly":false,"isSystem":false,"isLatest":true,"isPublished":true,"options":{"usableAsActivity":true,"autoUpdateConsumingWorkflows":true},"root":{"type":"Elsa.Flowchart","version":1,"id":"a2d5622db35b938","nodeId":"Workflow1:a2d5622db35b938","metadata":{},"customProperties":{"source":"FlowchartJsonConverter.cs:45","notFoundConnections":[],"canStartWorkflow":false,"runAsynchronously":false},"activities":[{"id":"92fb04ab997d4aea","nodeId":"Workflow1:a2d5622db35b938:92fb04ab997d4aea","name":"Start1","type":"Elsa.Start","version":1,"customProperties":{"canStartWorkflow":false,"runAsynchronously":false},"metadata":{"designer":{"position":{"x":-170.015625,"y":-80.5},"size":{"width":101.6484375,"height":50}}}},{"condition":{"typeName":"Boolean","expression":{"type":"JavaScript","value":"getVariable(\u0027DocumentSigned\u0027) === true"}},"id":"dc9c5c5b69138ffa","nodeId":"Workflow1:a2d5622db35b938:dc9c5c5b69138ffa","name":"FlowDecision1","type":"Elsa.FlowDecision","version":1,"customProperties":{"canStartWorkflow":false,"runAsynchronously":false},"metadata":{"designer":{"position":{"x":460.703125,"y":-80.5},"size":{"width":128.8515625,"height":50}}}},{"condition":{"typeName":"Boolean","expression":{"type":"JavaScript","value":"getVariable(\u0027DocumentSigningRetryCount\u0027) \u003C 3 \u0026\u0026 getVariable(\u0027DocumentSigned\u0027) !== true"}},"body":{"type":"Elsa.Flowchart","version":1,"id":"522a82daeb782f5","nodeId":"Workflow1:a2d5622db35b938:2408c563f2ff89ad:522a82daeb782f5","metadata":{},"customProperties":{"source":"FlowchartJsonConverter.cs:45","notFoundConnections":[],"canStartWorkflow":false,"runAsynchronously":false},"activities":[{"branches":{"typeName":"String[]","expression":{"type":"Object","value":"[\u0022request\u0022,\u0022timeout\u0022]"}},"id":"460afd848d878b09","nodeId":"Workflow1:a2d5622db35b938:2408c563f2ff89ad:522a82daeb782f5:460afd848d878b09","name":"FlowFork1","type":"Elsa.FlowFork","version":1,"customProperties":{"canStartWorkflow":false,"runAsynchronously":false},"metadata":{"designer":{"position":{"x":-420,"y":60},"size":{"width":144.3515625,"height":50}}}},{"script":{"typeName":"String","expression":{"type":"Literal","value":"return ((System.Text.Json.JsonElement)Output.Get(\u0022SendDocumentForSigning\u0022, \u0022Result\u0022)).GetRawText();"}},"possibleOutcomes":null,"result":null,"id":"85325a3637b1d309","nodeId":"Workflow1:a2d5622db35b938:2408c563f2ff89ad:522a82daeb782f5:85325a3637b1d309","name":"CastResult","type":"Elsa.RunCSharp","version":1,"customProperties":{"canStartWorkflow":false,"runAsynchronously":false},"metadata":{"designer":{"position":{"x":96.54739379882812,"y":-40},"size":{"width":85.5859375,"height":50}}}},{"taskName":{"typeName":"String","expression":{"type":"JavaScript","value":"getInput(\u0027TaskName\u0027)"}},"payload":{"typeName":"ObjectDictionary","expression":{"type":"JavaScript","value":"return ({\r\n    \u0022documentName\u0022: getInput(\u0027DocumentTemplate\u0027)\r\n})"}},"result":null,"id":"ed9022b839d070da","nodeId":"Workflow1:a2d5622db35b938:2408c563f2ff89ad:522a82daeb782f5:ed9022b839d070da","name":"SendDocumentForSigning","type":"Elsa.RunTask","version":1,"customProperties":{"canStartWorkflow":false,"runAsynchronously":false},"metadata":{"designer":{"position":{"x":-200,"y":-40},"size":{"width":262.6640625,"height":50}},"displayText":"Send Document for Signing"}},{"timeSpan":null,"id":"a6ca16fb1d22cd6e","nodeId":"Workflow1:a2d5622db35b938:2408c563f2ff89ad:522a82daeb782f5:a6ca16fb1d22cd6e","name":"Delay1","type":"Elsa.Delay","version":1,"customProperties":{"canStartWorkflow":false,"runAsynchronously":false},"metadata":{"designer":{"position":{"x":259.0473937988281,"y":129.5},"size":{"width":106.375,"height":50}}}},{"variable":{"id":"1c6cf9c82c0c6e06","name":"DocumentSigningRetryCount","typeName":"Int32","value":"0","storageDriverTypeName":"Elsa.Workflows.Services.WorkflowInstanceStorageDriver, Elsa.Workflows.Core"},"value":{"typeName":"Object","expression":{"type":"JavaScript","value":"getVariable(\u0027DocumentSigningRetryCount\u0027) \u002B 1"}},"id":"71678b336c700841","nodeId":"Workflow1:a2d5622db35b938:2408c563f2ff89ad:522a82daeb782f5:71678b336c700841","name":"SetVariable2","type":"Elsa.SetVariable","version":1,"customProperties":{"canStartWorkflow":false,"runAsynchronously":false},"metadata":{"designer":{"position":{"x":-720,"y":60},"size":{"width":226.8984375,"height":50}},"displayText":"Increment Retry Count"}},{"variable":{"id":"e0fceb85e4b752cc","name":"DocumentSigned","typeName":"Boolean","value":"False","storageDriverTypeName":"Elsa.Workflows.Services.WorkflowInstanceStorageDriver, Elsa.Workflows.Core"},"value":{"typeName":"Object","expression":{"type":"CSharp","value":"((System.Text.Json.JsonElement)Output.Get(\u0022SendDocumentForSigning\u0022, \u0022Result\u0022)).GetProperty(\u0022signed\u0022).GetBoolean()"}},"id":"e3a2f4c7128842b0","nodeId":"Workflow1:a2d5622db35b938:2408c563f2ff89ad:522a82daeb782f5:e3a2f4c7128842b0","name":"SetVariable1","type":"Elsa.SetVariable","version":1,"customProperties":{"canStartWorkflow":false,"runAsynchronously":false},"metadata":{"designer":{"position":{"x":259.0473937988281,"y":-40},"size":{"width":217.890625,"height":50}},"displayText":"Set Signing Outcome"}},{"mode":{"typeName":"Elsa.Workflows.Activities.Flowchart.Models.FlowJoinMode, Elsa.Workflows.Core","expression":{"type":"Literal","value":"WaitAny"}},"id":"56c6582bcaa53f5d","nodeId":"Workflow1:a2d5622db35b938:2408c563f2ff89ad:522a82daeb782f5:56c6582bcaa53f5d","name":"FlowJoin1","type":"Elsa.FlowJoin","version":1,"customProperties":{"canStartWorkflow":false,"runAsynchronously":false},"metadata":{"designer":{"position":{"x":560,"y":40},"size":{"width":97.78125,"height":50}}}}],"connections":[{"source":{"activity":"85325a3637b1d309","port":"Done"},"target":{"activity":"e3a2f4c7128842b0","port":"In"}},{"source":{"activity":"71678b336c700841","port":"Done"},"target":{"activity":"460afd848d878b09","port":"In"}},{"source":{"activity":"460afd848d878b09","port":"request"},"target":{"activity":"ed9022b839d070da","port":"In"}},{"source":{"activity":"460afd848d878b09","port":"timeout"},"target":{"activity":"a6ca16fb1d22cd6e","port":"In"}},{"source":{"activity":"a6ca16fb1d22cd6e","port":"Done"},"target":{"activity":"56c6582bcaa53f5d","port":"In"}},{"source":{"activity":"e3a2f4c7128842b0","port":"Done"},"target":{"activity":"56c6582bcaa53f5d","port":"In"}},{"source":{"activity":"ed9022b839d070da","port":"Done"},"target":{"activity":"85325a3637b1d309","port":"In"}}]},"id":"2408c563f2ff89ad","nodeId":"Workflow1:a2d5622db35b938:2408c563f2ff89ad","name":"While1","type":"Elsa.While","version":1,"customProperties":{"canStartWorkflow":false,"runAsynchronously":false},"metadata":{"designer":{"position":{"x":107.984375,"y":-115.5},"size":{"width":219.46875,"height":120}}}},{"outputName":{"typeName":"String","expression":{"type":"Literal","value":"SigningOutcome"}},"outputValue":{"typeName":"Object","expression":{"type":"Literal","value":"False"}},"id":"bb71ab73d8678e35","nodeId":"Workflow1:a2d5622db35b938:bb71ab73d8678e35","name":"SetOutputNotSigned","type":"Elsa.SetOutput","version":1,"customProperties":{"canStartWorkflow":false,"runAsynchronously":false},"metadata":{"designer":{"position":{"x":819.4609375,"y":27.38157844543457},"size":{"width":163.3125,"height":50}},"displayText":"Not Signed Output","showDescription":false}},{"outputName":{"typeName":"String","expression":{"type":"Literal","value":"SigningOutcome"}},"outputValue":{"typeName":"Object","expression":{"type":"Literal","value":"true"}},"id":"967d62f3b4bfd725","nodeId":"Workflow1:a2d5622db35b938:967d62f3b4bfd725","name":"SetOutputSigned","type":"Elsa.SetOutput","version":1,"customProperties":{"canStartWorkflow":false,"runAsynchronously":false},"metadata":{"designer":{"position":{"x":806.35546875,"y":-115.5},"size":{"width":133.53125,"height":50}},"displayText":"Signed Output"}},{"outcomes":{"typeName":"Object","expression":{"type":"Literal","value":"Signed"}},"id":"34438710a336b418","nodeId":"Workflow1:a2d5622db35b938:34438710a336b418","name":"Complete1","type":"Elsa.Complete","version":1,"customProperties":{"canStartWorkflow":false,"runAsynchronously":false},"metadata":{"designer":{"position":{"x":1057.08203125,"y":-115.5},"size":{"width":186.125,"height":50}},"displayText":"Outcome Signed"}},{"outcomes":{"typeName":"Object","expression":{"type":"Literal","value":"NotSigned"}},"id":"771d0689a202203b","nodeId":"Workflow1:a2d5622db35b938:771d0689a202203b","name":"Complete2","type":"Elsa.Complete","version":1,"customProperties":{"canStartWorkflow":false,"runAsynchronously":false},"metadata":{"designer":{"position":{"x":1069.08203125,"y":27.38157844543457},"size":{"width":211.90625,"height":50}},"displayText":"Outcome NotSigned"}}],"connections":[{"source":{"activity":"967d62f3b4bfd725","port":"Done"},"target":{"activity":"34438710a336b418","port":"In"}},{"source":{"activity":"bb71ab73d8678e35","port":"Done"},"target":{"activity":"771d0689a202203b","port":"In"}},{"source":{"activity":"dc9c5c5b69138ffa","port":"True"},"target":{"activity":"967d62f3b4bfd725","port":"In"}},{"source":{"activity":"dc9c5c5b69138ffa","port":"False"},"target":{"activity":"bb71ab73d8678e35","port":"In"}},{"source":{"activity":"2408c563f2ff89ad","port":"Done"},"target":{"activity":"dc9c5c5b69138ffa","port":"In"}},{"source":{"activity":"92fb04ab997d4aea","port":"Done"},"target":{"activity":"2408c563f2ff89ad","port":"In"}}]}}